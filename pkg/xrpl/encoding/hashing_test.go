package encoding

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/require"
)

func TestHashSigned(t *testing.T) {
	txBlob := "1200002280000000240000000161D4838D7EA4C6800000000000000000000000000055534400000000004B4E9C06F24296074F7BC48F92A97916C6DC5EA968400000000000000A732103AB40A0490F9B7ED8DF29D246BF2D6269820A0EE7742ACDD457BEA7C7D0931EDB74473045022100F8A650C1D58325FE8D74634C1DC0802BB2271EB84773793EF34085CFC7E32B1302206ECE43AFE94B7F9F0359D53E6B195C2D526DFDFBBBF328D6FE3A598F1D51DEBA81144B4E9C06F24296074F7BC48F92A97916C6DC5EA983143E9D4A2B8AA0780F682D136F7A56D6724EF53754"
	expectedHash := "7BF105CFE4EFE78ADB63FE4E03A851440551FE189FD4B51CAAD9279C9F534F0E"

	txB, err := hex.DecodeString(txBlob)
	require.NoError(t, err)

	expectedH, err := hex.DecodeString(expectedHash)
	require.NoError(t, err)

	computedH := HashSigned(txB)

	require.Equal(t, expectedH, computedH)
}
